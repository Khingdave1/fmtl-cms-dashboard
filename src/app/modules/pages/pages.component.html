<div class="main-body-content">
  <section class="pages">
    <div class="header">
      <h2>Pages</h2>
      <span>
        <button class="btn dark-blue-btn" (click)="openModal()">Add New</button>
      </span>
    </div>
    <div class="body">
      <div class="table">
        <div class="table-head table-row">
          <span class="table-head-item item">Name</span>
          <span class="table-head-item item">Description</span>
          <span class="table-head-item item">Image</span>
          <span class="table-head-item item">Actions</span>
        </div>
        <div class="table-body">
          <ng-container *ngIf="finance?.length > 0; else noItems">
            <div class="table-list table-row" *ngFor="let i of finance">
              <span class="table-list-item item image">{{ i.name }}</span>
              <span class="table-list-item item green-color">{{
                i.description
              }}</span>
              <span
                class="table-list-item item image"
                *ngFor="let childItem of i.images"
                ><img [src]="childItem.url" alt="image"
              /></span>
              <span class="table-list-item item action">
                <img
                  src="../../../assets/img/svg/edit.svg"
                  alt="image"
                  class="clickable reply"
                  title="Reply"
                  (click)="openEditModal(i)"
                />
                <img
                  src="../../../assets/img/svg/Delete.svg"
                  alt="image"
                  class="clickable delete"
                  title="Reply"
                  (click)="openDeleteModal(i)"
                />
              </span>
            </div>
          </ng-container>

          <!-- If the Product List is empty -->
          <ng-template #noItems>
            <p style="text-align: center; font-weight: 500">Empty list</p>
          </ng-template>
        </div>
      </div>
    </div>
  </section>
</div>

<div class="modal-area" [class.show-modal]="deleteModal">
  <div class="modal delete-modal">
    <div class="modal-head">
      <h2>Delete Item</h2>
    </div>
    <div class="modal-body">
      <p>
        Are you sure you want to permanently delete this
        <strong>{{ currentItem?.name }}</strong
        >?
      </p>
      <div class="modal-body-btns">
        <button class="btn tert-btn" (click)="deleteModal = false">
          Cancel
        </button>
        <button class="btn danger-btn" (click)="deleteFinance(currentItem._id)">
          Delete
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal-area" [class.show-modal]="modal">
  <div class="modal">
    <div class="modal-head">
      <h2>Add Finance</h2>
      <img
        src="../../../assets/img/svg/close.svg"
        alt="image"
        class="close-icon clickable"
        (click)="modal = false"
      />
    </div>
    <!-- (ngSubmit)="addFinanceData(usersForm.value)" #usersForm="ngForm"  -->
    <form [formGroup]="form" (ngSubmit)="addFinance()">
      <div class="form-field">
        <input
          type="text"
          name="name"
          placeholder="Title"
          formControlName="name"
          autocomplete="name"
        />
      </div>
      <div class="form-field">
        <textarea
          placeholder="Description"
          cols="30"
          rows="4"
          formControlName="description"
        ></textarea>
      </div>
      <input
        type="file"
        style="display: none"
        (change)="onFileSelect($event)"
        #productImage
      />
      <!-- The input is set to display none. so this will show instead -->
      <span (click)="productImage.click()" class="upload-img">
        <div class="form-field">
          Upload Image
          <img src="../../../assets/img/svg/upload.svg" alt="" />
        </div>
        <h5 class="selected-img">{{ selectedFileName }}</h5>
      </span>

      <!-- Error -->
      <span class="message" id="message" [class.show]="showError">{{
        errorMessage
      }}</span>

      <button class="btn dark-blue-btn clickable">
        <span *ngIf="loading">Saving...</span>
        <span *ngIf="!loading">Save</span>
      </button>
    </form>
  </div>
</div>

<!-- Edit Modal -->
<div class="modal-area" [class.show-modal]="editModal">
  <div class="modal">
    <div class="modal-head">
      <h2>Edit Finance</h2>
      <img
        src="../../../assets/img/svg/close.svg"
        alt="image"
        class="close-icon clickable"
        (click)="editModal = false"
      />
    </div>
    <!-- (ngSubmit)="addFinanceData(usersForm.value)" #usersForm="ngForm"  -->
    <form [formGroup]="form" (ngSubmit)="editFinance(currentItem._id)">
      <div class="form-field">
        <input
          type="text"
          name="name"
          placeholder="Title"
          formControlName="name"
          autocomplete="name"
          [value]="currentItem?.name"
        />
      </div>
      <div class="form-field">
        <textarea
          placeholder="Description"
          cols="30"
          rows="4"
          formControlName="description"
          [value]="currentItem?.description"
        ></textarea>
        <!-- [(ngModel)]="currentItem2.description" -->
      </div>
      <input
        type="file"
        style="display: none"
        (change)="onFileSelect($event)"
        #productImage
      />
      <!-- The input is set to display none. so this will show instead -->
      <span (click)="productImage.click()" class="upload-img">
        <div class="form-field">
          Upload Image
          <img src="../../../assets/img/svg/upload.svg" alt="" />
        </div>
        <h5 class="selected-img">{{ selectedFileName }}</h5>
      </span>

      <!-- Error -->
      <span class="message" id="message" [class.show]="showError">{{
        errorMessage
      }}</span>

      <button class="btn dark-blue-btn clickable">
        <span *ngIf="loading">Saving...</span>
        <span *ngIf="!loading">Save</span>
      </button>
    </form>
  </div>
</div>

<div class="alert-popup" [class.show]="alertPopup">
  <div class="alert-popup-content">
    <p>{{ alertPopupMessage }}</p>
  </div>
</div>
